# Unlinked-regression

Обозначим через $\mathcal{G}(F, G, a, n, z)$ - алгоритм генерации набора данных размера $n$ для модели $Y = aX + \varepsilon$, в которой случайные величины $X$ и $\varepsilon$ являются независимыми и имеют распределения $F$ и $G$ соответственно, а также для этого набора данных $l(n) = \left[z \cdot n \right]$, где $z \in [0, 1]$.

Алгоритм генерации.

Положим $n_{dep} = \left[z \cdot n \right]$, $n_{ind} = n - n_{dep}$. Тогда набор данных можно получить по следующей процедуре (назовем ее $\mathcal{G}$-процедура):
\begin{enumerate}
\item Генерация пар:
	\begin{enumerate}
	\item Из распределения $\mathcal{H}_k$ сгенерировать $n_{dep}$ независимых случайных величин $\{X_i\}_{n_{dep}}$;
	\item Из стандартного нормального распределения $\mathcal{N}_{0,1}$, независимо от $\{X_i\}_{n_{dep}}$, сгенерировать
	 $n_{dep}$ независимых случайных величин $\{\varepsilon_i\}_{n_{dep}}$;
	 \item Построить выборку $\{Y_i\}_{n_{dep}}$ размера $n_{dep}$ по формуле $Y_i = X_i + \varepsilon_i$.
	\end{enumerate}
\item Генерация случайных величин без пар:
	\begin{enumerate}
	\item Из распределения $\mathcal{H}_k$, независимо от всего остального, сгенерировать 
	$n_{ind}$ независимых случайных величин $\{\widetilde{X}_i\}$;
	\item Из стандартного нормального распределения $\mathcal{N}_{0,1}$, независимо от всего остального, сгенерировать
	 $n_{ind}$ независимых случайных величин $\{\widetilde{\varepsilon}_i\}$;
	 \item По полученным наборам $\{\widetilde{X}_i\}$ и $\{\widetilde{\varepsilon}_i\}$ построить выборку $\{Y_i\}_{n_{ind}}$ размера
	 $n_{ind}$ по формуле $Y_i = \widetilde{X}_i + \widetilde{\varepsilon}_i$;
	 \item Из распределения $\mathcal{H}_k$, независимо от всего остального, сгенерировать 
	$n_{ind}$ независимых случайных величин $\{X_i\}_{n_{ind}}$.
	\end{enumerate}
\item Объединение наборов 
$$
\{X_i\} = \mathrm{perm}\left( \{X_i\}_{n_{dep}} \cup \{X_i\}_{n_{ind}} \right) \text{ и } \{ Y_i \} = \mathrm{perm}\left(\{Y_i\}_{n_{dep}} \cup \{Y_i\}_{n_{ind}}\right),
$$ 
где $\mathrm{perm}\left( \right)$ --- оператор случайной перестановки.
\end{enumerate}






Опишем процедуру генерации данных, соответствующих этой модели. Пусть $n$ — общее количество каждой из генерируемых случайных величин $X, \varepsilon$, и пусть $z \in [0,1]$. Положим
$$
n_{dep} = \lfloor z \cdot n \rfloor, \qquad
n_{ind} = n - n_{dep}.
$$

Тогда набор данных можно получить по следующей процедуре (назовем её $\mathcal{G}$-процедура):

---

### 1. Генерация пар

1.1. Из распределения $\mathcal{H}_k$ сгенерировать $n_{dep}$ независимых случайных величин $\{X_i\}_{n_{dep}}$.

1.2. Из стандартного нормального распределения $\mathcal{N}(0,1)$, независимо от $\{X_i\}_{n_{dep}}$, сгенерировать $n_{dep}$ независимых случайных величин $\{\varepsilon_i\}_{n_{dep}}$.

1.3. Построить выборку $\{Y_i\}_{n_{dep}}$ размера $n_{dep}$ по формуле
$$
Y_i = X_i + \varepsilon_i.
$$

---

### 2. Генерация случайных величин без пар

2.1. Из распределения $\mathcal{H}_k$, независимо от всего остального, сгенерировать $n_{ind}$ независимых случайных величин $\{\widetilde{X}_i\}$.

2.2. Из стандартного нормального распределения $\mathcal{N}(0,1)$, независимо от всего остального, сгенерировать $n_{ind}$ независимых случайных величин $\{\widetilde{\varepsilon}_i\}$.

2.3. По полученным наборам $\{\widetilde{X}_i\}$ и $\{\widetilde{\varepsilon}_i\}$ построить выборку $\{Y_i\}_{n_{ind}}$ размера $n_{ind}$ по формуле
$$
Y_i = \widetilde{X}_i + \widetilde{\varepsilon}_i.
$$

2.4. Из распределения $\mathcal{H}_k$, независимо от всего остального, сгенерировать $n_{ind}$ независимых случайных величин $\{X_i\}_{n_{ind}}$.

---

### 3. Объединение наборов

$$
\{X_i\} = \mathrm{perm}\left( \{X_i\}_{n_{dep}} \cup \{X_i\}_{n_{ind}} \right),
$$

$$
\{Y_i\} = \mathrm{perm}\left( \{Y_i\}_{n_{dep}} \cup \{Y_i\}_{n_{ind}} \right),
$$

где $\mathrm{perm}(\cdot)$ — оператор случайной перестановки.
