# Unlinked-regression

Обозначим через $\mathcal{G}(F, G, a, n, z)$ - алгоритм генерации набора данных размера $n$ для модели $Y = aX + \varepsilon$, в которой случайные величины $X$ и $\varepsilon$ являются независимыми и имеют распределения $F$ и $G$ соответственно, а также для этого набора данных $l(n) = \left[z \cdot n \right]$, где $z \in [0, 1]$.

Алгоритм генерации.

Положим $n_{dep} = \left[z \cdot n \right]$, $n_{ind} = n - n_{dep}$. Тогда набор данных можно получить по следующей процедуре (назовем ее $\mathcal{G}$-процедура):
\begin{enumerate}
\item Генерация пар:
	\begin{enumerate}
	\item Из распределения $\mathcal{H}_k$ сгенерировать $n_{dep}$ независимых случайных величин $\{X_i\}_{n_{dep}}$;
	\item Из стандартного нормального распределения $\mathcal{N}_{0,1}$, независимо от $\{X_i\}_{n_{dep}}$, сгенерировать
	 $n_{dep}$ независимых случайных величин $\{\varepsilon_i\}_{n_{dep}}$;
	 \item Построить выборку $\{Y_i\}_{n_{dep}}$ размера $n_{dep}$ по формуле $Y_i = X_i + \varepsilon_i$.
	\end{enumerate}
\item Генерация случайных величин без пар:
	\begin{enumerate}
	\item Из распределения $\mathcal{H}_k$, независимо от всего остального, сгенерировать 
	$n_{ind}$ независимых случайных величин $\{\widetilde{X}_i\}$;
	\item Из стандартного нормального распределения $\mathcal{N}_{0,1}$, независимо от всего остального, сгенерировать
	 $n_{ind}$ независимых случайных величин $\{\widetilde{\varepsilon}_i\}$;
	 \item По полученным наборам $\{\widetilde{X}_i\}$ и $\{\widetilde{\varepsilon}_i\}$ построить выборку $\{Y_i\}_{n_{ind}}$ размера
	 $n_{ind}$ по формуле $Y_i = \widetilde{X}_i + \widetilde{\varepsilon}_i$;
	 \item Из распределения $\mathcal{H}_k$, независимо от всего остального, сгенерировать 
	$n_{ind}$ независимых случайных величин $\{X_i\}_{n_{ind}}$.
	\end{enumerate}
\item Объединение наборов 
$$
\{X_i\} = \mathrm{perm}\left( \{X_i\}_{n_{dep}} \cup \{X_i\}_{n_{ind}} \right) \text{ и } \{ Y_i \} = \mathrm{perm}\left(\{Y_i\}_{n_{dep}} \cup \{Y_i\}_{n_{ind}}\right),
$$ 
где $\mathrm{perm}\left( \right)$ --- оператор случайной перестановки.
\end{enumerate}







Обозначим через $\mathcal{G}(F, G, a, n, z)$ алгоритм генерации набора данных размера $n$ для модели $Y = aX + \varepsilon$, в которой случайные величины $X$ и $\varepsilon$ являются независимыми и имеют распределения $F$ и $G$ соответственно, а также для этого набора данных $l(n) = \left[z \cdot n \right]$, где $z \in [0, 1]$.

**Алгоритм генерации**

Положим $n_{dep} = \left[z \cdot n \right]$, $n_{ind} = n - n_{dep}$. Тогда набор данных можно получить по следующей процедуре (назовем ее $\mathcal{G}$-процедура):

1. **Генерация пар:**
   - Из распределения $\mathcal{H}_k$ сгенерировать $n_{dep}$ независимых случайных величин $\{X_i\}_{n_{dep}}$;
   - Из стандартного нормального распределения $\mathcal{N}_{0,1}$, независимо от $\{X_i\}_{n_{dep}}$, сгенерировать $n_{dep}$ независимых случайных величин $\{\varepsilon_i\}_{n_{dep}}$;
   - Построить выборку $\{Y_i\}_{n_{dep}}$ размера $n_{dep}$ по формуле $Y_i = X_i + \varepsilon_i$.

2. **Генерация случайных величин без пар:**
   - Из распределения $\mathcal{H}_k$, независимо от всего остального, сгенерировать $n_{ind}$ независимых случайных величин $\{\widetilde{X}_i\}$;
   - Из стандартного нормального распределения $\mathcal{N}_{0,1}$, независимо от всего остального, сгенерировать $n_{ind}$ независимых случайных величин $\{\widetilde{\varepsilon}_i\}$;
   - По полученным наборам $\{\widetilde{X}_i\}$ и $\{\widetilde{\varepsilon}_i\}$ построить выборку $\{Y_i\}_{n_{ind}}$ размера $n_{ind}$ по формуле $Y_i = \widetilde{X}_i + \widetilde{\varepsilon}_i$;
   - Из распределения $\mathcal{H}_k$, независимо от всего остального, сгенерировать $n_{ind}$ независимых случайных величин $\{X_i\}_{n_{ind}}$.

3. **Объединение наборов**

$$
\{X_i\} = \mathrm{perm}\left( \{X_i\}_{n_{dep}} \cup \{X_i\}_{n_{ind}} \right) \quad \text{и} \quad \{ Y_i \} = \mathrm{perm}\left(\{Y_i\}_{n_{dep}} \cup \{Y_i\}_{n_{ind}}\right),
$$

где $\mathrm{perm}(\cdot)$ — оператор случайной перестановки.
